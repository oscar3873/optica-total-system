{% extends 'core/base.html' %}
{% load static %}
{% load humanize %}


{% block main %}
   
<!-- ===============================================-->
<!--    Contentenedor del block main-->
<!-- ===============================================-->

<div class="container py-4">

    <!-- ===============================================-->
    <!--    Errores de Sistema (Backend)-->
    <!-- ===============================================-->

    {% if messages %}
        {% for message in messages %}
          <div class="alert alert-warning border-2 d-flex align-items-center" role="alert">
            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
            <p class="mb-0 flex-1">{{ message }}</p>
            <button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
    {% endif %}

    <!-- ===============================================-->
    <!--    Fin Errores de Sistema (Backend)-->
    <!-- ===============================================-->

    <!-- ===============================================-->
    <!--    Formulario de Categoria   -->
    <!-- ===============================================-->
    
    <h4>Categoria</h4>
    {{category_form.as_p}}

    <!-- ===============================================-->
    <!--    Fin Formulario de Categoria   -->
    <!-- ===============================================-->

    <!-- ===============================================-->
    <!--    Formulario de Categoria   -->
    <!-- ===============================================-->
    
    <h4>Marca</h4>
    {{brand_form.as_p}}

    <!-- ===============================================-->
    <!--    Fin Formulario de Categoria   -->
    <!-- ===============================================-->


    <!-- ===============================================-->
    <!--    Formulario de Producto/Caracteristica   -->
    <!-- ===============================================-->
    <h4>Producto</h4>
		<div class="col-lg-6 col-xl-12 col-xxl-6 h-100">
			<div class="card theme-wizard h-100 mb-5">     
				<div class="card-body py-4" id="wizard-controller">
					<div class="tab-content">
						<div class="tab-pane active px-sm-3 px-md-5" role="tabpanel" aria-labelledby="bootstrap-wizard-validation-tab1" id="bootstrap-wizard-validation-tab1">
							<form class="mt-3" method="post">
                {% csrf_token %}
                <div class="mb-3">
                  <!-- FORMULARIO DE PRODUCTO CON FEATURES -->
                    {{form.as_p}} 
                </div>
                {% with named_formsets as formset %}
                    {{ formset.management_form }}
                    <script type="text/html" id="variants-template">
                        <tr id="variants-__prefix__" class="hide_all">
                            {% for fields in formset.empty_form.hidden_fields %}
                                {{fields.label}}: {{fields}}
                            {% endfor %}
                            {% for fields in formset.empty_form.visible_fields %}
                                <td>{{fields.label}}: {{fields}}</td>
                            {% endfor %}
                            <td>
                                <button type="button" class="btn btn-danger delete-variant">Delete</button>
                            </td>
                        </tr>
                    </script>
                    <div class="table-responsive card mt-4">
                        Add Features
                        <div id="item-variants">
                            {% for formss in formset %}
                                {{ formss.management_form }}
                                <tr id="variants-{{ forloop.counter0 }}" class="hide_all">
                                    {{ formss.id }}
                                    {% for field in formss.visible_fields %}
                                        <td>
                                            {{field.label}}: {{field}}
                                        </td>
                                    {% endfor %}
                                    <td>
                                        {% if formss.instance.pk %}
                                            <button type="button" class="btn btn-danger delete-variant">Delete</button>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                            </div>
                        <a href="#" id="add-variant-button" class="btn btn-secondary add-variants">Add More</a>
                    </div>
                {% endwith %}
                <button class="btn btn-primary d-block w-100 mt-3" type="submit" name="submit">Registrar</button>
            </form>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>    

    <!-- =================================================-->
    <!--   Fin de Formulario de Producto/Caracteristica   -->
    <!-- =================================================-->

</div>

<!-- ===============================================-->
<!--    Fin Contentenedor del block main-->
<!-- ===============================================-->
{% endblock main %}


{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="{% static 'products/js/formset.js' %}"></script> <!-- Agregar este enlace -->
{% endblock extra_js %}