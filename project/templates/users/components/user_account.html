
<div class="container py-4">


  {% include 'core/components/messages.html' %}
  
  <!-- ===============================================-->
  <!--    Fin Errores de Sistema (Backend)-->
  <!-- ===============================================-->




  <!-- ===============================================-->
  <!--    Card con la presentacion de la caja-->
  <!-- ===============================================-->

  {% if object %}
  <div class="h-100">
    <div class="card mb-3">
        <div class="row g-3 mb-3">
            <div class="col-xxl-4 col-md-6 ">
              <div class = "ml-4">
                <div class="card-header position-relative min-vh-25 mb-7 ">
                  <div class="bg-holder rounded-3 rounded-bottom-0" style="background-image:url(../../assets/img/generic/4.jpg);">
                  </div>
                  <!--/.bg-holder-->
                  
                  <div class="avatar avatar-5xl avatar-profile">
                      <img class="rounded-circle img-thumbnail shadow-sm" id="profile-image-preview" src="{{ object.imagen.url }}" width="200" alt="Imagen del admin" />
                    <label for="id_imagen" class="rounded-circle custom-file-upload dark__text-white">
                      Cambiar Foto
                    </label>
                  </div>
              </div>
            </div>
            <form method="post" id="profile-image-form" class="pt-3 ps-2" enctype="multipart/form-data" action="{% url 'users_app:change_img' object.pk %}">
              {% csrf_token %}
              <div hidden>
                {{ change_image.imagen }}
              </div>
              <div id="profile-image-buttons" style="display: none;">
                  <button class="btn btn-primary" type="submit">Guardar</button>
                  <button class="btn btn-danger" type="button" id="cancel-img-button">Cancelar</button>
              </div>
            </form>
        </div>
            <div class="col-12 col-sm-6">
            </div>
            
        </div>
    </div>

    <div class="card-body">
        <div class="row">
          <div class="col-lg-8">
            <h4 class="mb-1"> {{object}}
            </h4>
            {% if user.is_staff %}
            <h5 class="fs-0 fw-normal">Administrador de Optica Total</h5> <!--Esto de 'Optica Total' es hardcodeo en la proxima version almacenar datos del negocio-->
            {% else %}
            <h5 class="fs-0 fw-normal">Empleado de Optica Total</h5>
            {% endif %}
            <p class="text-500">{{object.email}}</p>
            
            <div class="border-dashed-bottom my-4 d-lg-none"></div>
          </div>
        </div>
    </div>
    <div class="row g-0 ">
      <div class="col-12 col-lg-8 pe-lg-2">
        <div class="card mb-3">
          <div class="card-header bg-light">
            <h5 class="mb-0">Datos personales</h5>
          </div>
						<div class="card theme-wizard h-100">
							<!-- Card body -->
                <div class="card-body py-2" id="wizard-controller">
                  <div class="row">
                    <form method="post" id="singup-user" class="row g-3 update-form">
                      {% csrf_token %}
                      <div class="tab-content">
                          <div class="row">
                              <div class="col-sm-6">
                                <label for="{{ form.first_name.id_for_label }}" class="form-label">Nombre:</label>
                                  {{ form.first_name }}
                                {% if form.first_name.errors %}
                                <div class="text-danger fs--2">
                                  {{form.first_name.errors}}
                                </div>
                                {% endif %}
                              </div>
                              <div class="col-sm-6 pt-2 pt-sm-0">
                                <label for="{{ form.last_name.id_for_label }}" class="form-label">Apellido:</label>
                                  {{ form.last_name }}
                                {% if form.last_name.errors %}
                                <div class="text-danger fs--2">
                                  {{form.last_name.errors}}
                                </div>
                                {% endif %}
                              </div>
                          </div>
                          <div class="row pt-sm-2">
                            <div class="col-sm-6">
                              <label for="{{ form.birth_date.id_for_label }}" class="form-label">Fecha de nacimiento:</label>
                                {{ form.birth_date }}
                              {% if form.birth_date.errors %}
                              <div class="text-danger fs--2">
                                {{form.birth_date.errors}}
                              </div>
                              {% endif %}
                            </div>
                            <div class="col-sm-6">
                              <label for="{{ form.email.id_for_label }}" class="form-label ">Correo:</label>
                                {{ form.email }}
                              {% if form.email.errors %}
                              <div class="text-danger fs--2">
                                {{form.email.errors}}
                              </div>
                              {% endif %}
                            </div>
                          </div>
                          <div class="row pt-sm-2">
                            <div class="col-sm-5 pt-2 pt-sm-0">
                              <label for="{{ form.dni.id_for_label }}" class="form-label">DNI/CUIL/CUIT:</label>
                                {{ form.dni }}
                              {% if form.dni.errors %}
                              <div class="text-danger fs--2">
                                {{form.dni.errors}}
                              </div>
                              {% endif %}
                            </div> 
                            <div class="col-5 col-sm-2 pt-2 pt-sm-0">
                              <label for="{{ form.phone_code.id_for_label }}" class="form-label">Código:</label>
                                {{ form.phone_code }}
                              {% if form.phone_code.errors %}
                              <div class="text-danger fs--2">
                                {{form.phone_code.errors}}
                              </div>
                              {% endif %}
                            </div>
                            <div class="col-7 col-sm-5 pt-2 pt-sm-0">
                              <label for="{{ form.phone_number.id_for_label }}" class="form-label">Celular:</label>
                                {{ form.phone_number }}
                              {% if form.phone_number.errors %}
                              <div class="text-danger fs--2">
                                {{form.phone_number.errors}}
                              </div>
                              {% endif %}
                            </div>
                          </div>
                          <div class="row pt-sm-2">
                            <div class="col-12 pt-2 pt-sm-0">
                              <label for="{{ form.address.id_for_label }}" class="form-label">Domicilio:</label>
                              {{ form.address }}
                              {% if form.address.errors %}
                              <div class="text-danger fs--2">
                                {{form.address.errors}}
                              </div>
                              {% endif %}
                            </div>
                          </div>
                          <div class="mt-4 mb-2 text-center ">
                            <button class="btn btn-warning px-2 " type="submit">Guardar Cambios</button>
                            <button class="btn btn-secondary px-5 " type="button" id="Cancel_button_form">Cancelar</button>
                            <button class="btn btn-primary px-5" type="button" id="Update_button_form">Editar</button>
                          </div>
                          <input type="hidden" name="is_editable" value="{{ is_editable }}">
                        
                      </div>
                    </form>

                  </div>
                </div>
            </div>
        </div>
      </div>
        <div class="col-lg-4 ps-lg-2">
          <div class="sticky-sidebar">
            <div class="card mb-3">
              <div class="card-header bg-light">
                <h5 class="mb-0">Cambiar Contraseña</h5>
              </div>
              <div class="card-body fs--1">
                <form method="post" action="{% url 'users_app:update_password' object.pk %}" id="password-form" class="row g-2" novalidate>
                  {% csrf_token %}
                  <label for="{{ form.passwordCurrent.id_for_label }}" class="form-label">Contraseña Actual:</label>
                  {{ form2.passwordCurrent }}
                  {% if form2.passwordCurrent.errors %}
                    <div class="text-danger fs--2">
                      {{form2.passwordCurrent.errors.0}}
                    </div>
                  {% endif %}
                    
                    
                  <div id="password-error-message" class="text-danger"></div>

                  <label for="{{ form.password.id_for_label }}" class="form-label">Ingrese nueva contraseña:</label>
                  {{ form2.password }}
                  {% if form2.password.errors %}
                    <div class="text-danger fs--2">
                      {{form2.password.errors.0}}
                    </div>
                  {% endif %}
                
                  <label for="{{ form.password2.id_for_label }}" class="form-label">Repita la nueva contraseña:</label>
                                  
                  {{ form2.password2 }}
                  {% if form2.password2.errors %}
                    <div class="text-danger fs--2">
                      {{form2.password2.errors.0}}
                    </div>
                  {% endif %}
                  <input type="hidden" name="change_password_form" value="True">
                  
                  <div class="mt-4 mb-2 text-center ">
                    <button class="btn btn-warning px-2" type="submit" name="submit-button" form="password-form">Cambiar contraseña<span class="fas fa-chevron-right ms-2"
                        data-fa-transform="shrink-3">
                    </button>
                  </div>
              </form>
              </div>
            </div>
          </div>
        </div>
    </div>
      
  </div>

  {% endif %}
  
  <!-- ===============================================-->
  <!--    Fin Contentenedor del block main-->
  <!-- ===============================================-->
</div>

<!-- ===============================================-->
<!--   Fin Card con la presentacion de la caja-->
<!-- ===============================================-->